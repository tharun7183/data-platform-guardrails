name: ci
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    env:
      PYTHONPATH: ${{ github.workspace }}
      SPARK_LOCAL_IP: 127.0.0.1

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      # PySpark needs Java
      - name: Set up Java
      - uses: actions/setup-java@v4
        with:
          distribution: "temurin"
          java-version: "17"

      - run: pip install -U pip
      - run: pip install pyspark pytest

      # Optional: show versions (helps debugging)
      - run: python -V && java -version

      - name: Run tests
        run: pytest -q
